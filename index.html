<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieFlix - Cat√°logo de Pel√≠culas con IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.18.0/dist/tf.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .movie-card { transition: transform 0.3s ease; }
        .movie-card:hover { transform: scale(1.05); }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .placeholder-movie {
            background: linear-gradient(45deg, #2d3748, #4a5568);
            display: flex; align-items: center; justify-content: center;
            color: #cbd5e0; font-size: 20px;
        }
        .poster-image {
            height: 400px;
            object-fit: cover;
            width: 100%;
        }
        .platform-logo {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }
        .comment {
            border-left: 3px solid #3b82f6;
            background-color: #1f2937;
        }
        @media (max-width: 768px) {
            .poster-image {
                height: 320px;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-900 text-white">
    <header class="bg-gray-800 shadow-lg">
        <nav class="container mx-auto px-6 py-3">
            <div class="flex justify-between items-center">
                <a href="#" class="text-2xl font-bold text-blue-400" onclick="showPage('home')">
                    <span role="img" aria-label="Movie camera">üé¨</span> MovieFlix
                </a>
                <div class="flex space-x-4">
                    <a href="#" class="px-3 py-2 rounded hover:bg-gray-700" onclick="showPage('home')">Inicio</a>
                    <a href="#" class="px-3 py-2 rounded hover:bg-gray-700" onclick="showPage('catalog')">Cat√°logo</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-10">
        <!-- P√°gina de Inicio -->
        <div id="home-page" class="fade-in">
            <section class="text-center py-20" aria-labelledby="main-heading">
                <h1 id="main-heading" class="text-5xl font-bold mb-6">Bienvenido a MovieFlix</h1>
                <p class="text-xl mb-10">Descubre pel√≠culas incre√≠bles y recibe recomendaciones personalizadas con tecnolog√≠a de IA</p>
                <button onclick="showPage('catalog')" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-300">
                    Explorar Cat√°logo
                </button>
            </section>
            
            <section class="py-16" aria-labelledby="features-heading">
                <h2 id="features-heading" class="text-3xl font-bold text-center mb-12">Caracter√≠sticas Principales</h2>
                <div class="grid md:grid-cols-3 gap-8">
                    <article class="bg-gray-800 p-6 rounded-lg shadow-lg text-center">
                        <div class="text-blue-400 text-4xl mb-4" aria-hidden="true">üé¨</div>
                        <h3 class="text-xl font-semibold mb-3">Cat√°logo Completo</h3>
                        <p>Explora miles de pel√≠culas con informaci√≥n detallada y filtros avanzados.</p>
                    </article>
                    
                    <article class="bg-gray-800 p-6 rounded-lg shadow-lg text-center">
                        <div class="text-blue-400 text-4xl mb-4" aria-hidden="true">ü§ñ</div>
                        <h3 class="text-xl font-semibold mb-3">Recomendaciones IA</h3>
                        <p>Sistema de recomendaci√≥n inteligente basado en tus preferencias y valoraciones.</p>
                    </article>
                    
                    <article class="bg-gray-800 p-6 rounded-lg shadow-lg text-center">
                        <div class="text-blue-400 text-4xl mb-4" aria-hidden="true">üì±</div>
                        <h3 class="text-xl font-semibold mb-3">Dise√±o Responsive</h3>
                        <p>Disfruta de la experiencia en cualquier dispositivo, desde m√≥viles hasta desktop.</p>
                    </article>
                </div>
            </section>
        </div>

        <!-- P√°gina de Cat√°logo -->
        <div id="catalog-page" class="hidden fade-in">
            <header class="text-center mb-10">
                <h1 class="text-4xl font-bold mb-4">Cat√°logo de Pel√≠culas</h1>
                <p class="text-xl text-gray-300">Explora nuestro extenso cat√°logo y encuentra tu pr√≥xima pel√≠cula favorita</p>
            </header>
            
            <div class="bg-gray-800 p-6 rounded-lg shadow-lg mb-8">
                <form onsubmit="handleSearch(event)" class="mb-6">
                    <div class="flex">
                        <input type="text" id="search-input" placeholder="Buscar pel√≠culas..." class="flex-grow px-4 py-2 rounded-l-lg bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-r-lg transition duration-300">Buscar</button>
                    </div>
                </form>

                <div>
                    <h3 class="text-lg font-semibold mb-3">Filtrar por g√©nero:</h3>
                    <div class="flex flex-wrap gap-2">
                        <button class="px-4 py-2 rounded-full text-sm bg-gray-700 hover:bg-gray-600" onclick="filterByGenre('Action')">Acci√≥n</button>
                        <button class="px-4 py-2 rounded-full text-sm bg-gray-700 hover:bg-gray-600" onclick="filterByGenre('Comedy')">Comedia</button>
                        <button class="px-4 py-2 rounded-full text-sm bg-gray-700 hover:bg-gray-600" onclick="filterByGenre('Drama')">Drama</button>
                        <button class="px-4 py-2 rounded-full text-sm bg-gray-700 hover:bg-gray-600" onclick="filterByGenre('Sci-Fi')">Ciencia Ficci√≥n</button>
                        <button class="px-4 py-2 rounded-full text-sm bg-gray-700 hover:bg-gray-600" onclick="filterByGenre('Adventure')">Aventura</button>
                        <button class="px-4 py-2 rounded-full text-sm bg-gray-700 hover:bg-gray-600" onclick="filterByGenre('Fantasy')">Fantas√≠a</button>
                        <button class="px-4 py-2 rounded-full text-sm bg-red-600 hover:bg-red-700" onclick="clearFilters()">Limpiar</button>
                    </div>
                </div>
            </div>
            
            <div id="search-results" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8"></div>
            
            <div id="loading-indicator" class="text-center py-12 hidden">
                <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500" aria-hidden="true"></div>
                <p class="mt-4">Cargando pel√≠culas...</p>
            </div>
            
            <div id="error-message" class="bg-red-800 text-white p-4 rounded-lg mb-8 text-center hidden" role="alert">
                <span class="font-semibold">Error: </span>
                <span id="error-text"></span>
            </div>
        </div>

        <!-- P√°gina de Detalle de Pel√≠cula -->
        <div id="detail-page" class="hidden fade-in">
            <button onclick="showPage('catalog')" class="inline-block mb-6 text-blue-400 hover:underline">‚Üê Volver al cat√°logo</button>
            <div id="movie-detail-content"></div>
        </div>
    </main>

    <footer class="bg-gray-800 border-t border-gray-700 mt-20">
        <div class="container mx-auto px-6 py-8">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-lg font-semibold mb-4">MovieFlix</h3>
                    <p class="text-gray-400">Tu cat√°logo de pel√≠culas con recomendaciones inteligentes basadas en IA.</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Enlaces R√°pidos</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white" onclick="showPage('home')">Inicio</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white" onclick="showPage('catalog')">Cat√°logo</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Tecnolog√≠as</h3>
                    <ul class="text-gray-400 space-y-1">
                        <li>HTML5 + JavaScript</li>
                        <li>TensorFlow.js</li>
                        <li>Tailwind CSS</li>
                        <li>OMDb API</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2024 MovieFlix. Proyecto acad√©mico para Desarrollo Web con IA.</p>
            </div>
        </div>
    </footer>

    <script>
        let currentMovies = [];
        let recommendationModel = null;

        // Datos de plataformas de streaming
        const streamingPlatforms = {
            "Netflix": { color: "bg-red-600", icon: "fab fa-netflix" },
            "Amazon Prime": { color: "bg-blue-500", icon: "fab fa-amazon" },
            "Disney+": { color: "bg-blue-700", icon: "fas fa-crown" },
            "HBO Max": { color: "bg-purple-600", icon: "fab fa-hbo" },
            "Apple TV+": { color: "bg-gray-800", icon: "fab fa-apple" },
            "Hulu": { color: "bg-green-600", icon: "fas fa-play" },
            "Paramount+": { color: "bg-blue-600", icon: "fas fa-plus" }
        };

        // Asignar plataformas a pel√≠culas (simulado)
        const moviePlatforms = {
            "tt0848228": ["Netflix", "Disney+"],
            "tt0111161": ["Amazon Prime", "HBO Max"],
            "tt0133093": ["Netflix", "Hulu"],
            "tt1375666": ["Amazon Prime", "HBO Max"],
            "tt0120737": ["Amazon Prime", "HBO Max"],
            "tt0167260": ["Amazon Prime", "HBO Max"],
            "tt0137523": ["Netflix", "Hulu"],
            "tt0076759": ["Disney+"],
            "tt0080684": ["Disney+"],
            "tt0086190": ["Disney+"],
            "tt0110912": ["Netflix", "HBO Max"],
            "tt0109830": ["Netflix", "Amazon Prime"],
            "tt0120815": ["Netflix", "Paramount+"],
            "tt0110357": ["Disney+"],
            "tt0317705": ["Disney+"],
            "tt0241527": ["Amazon Prime", "HBO Max"],
            "tt0295297": ["Amazon Prime", "HBO Max"],
            "tt0304141": ["Amazon Prime", "HBO Max"],
            "tt0330373": ["Amazon Prime", "HBO Max"],
            "tt0373889": ["Amazon Prime", "HBO Max"],
            "tt0417741": ["Amazon Prime", "HBO Max"],
            "tt0926084": ["Amazon Prime", "HBO Max"],
            "tt1201607": ["Amazon Prime", "HBO Max"],
            "tt0468569": ["Netflix", "HBO Max"],
            "tt1345836": ["Netflix", "HBO Max"],
            "tt0114709": ["Disney+"],
            "tt0120363": ["Disney+"],
            "tt0435761": ["Disney+"],
            "tt1979376": ["Disney+"],
            "tt0119217": ["Netflix", "Amazon Prime"],
            "tt0108052": ["Netflix", "Amazon Prime"],
            "tt0088763": ["Netflix", "Amazon Prime"]
        };

        // Datos de comentarios (almacenamiento local)
        let movieComments = JSON.parse(localStorage.getItem('movieComments')) || {};

        const sampleMovies = [
            { imdbID: "tt0848228", Title: "The Avengers", Year: "2012", Poster: "https://m.media-amazon.com/images/M/MV5BNDYxNjQyMjAtNTdiOS00NGYwLWFmNTAtNThmYjU5ZGI2YTI1XkEyXkFqcGdeQXVyMTMxODk2OTU@._V1_SX300.jpg", Genre: "Action, Adventure, Sci-Fi", Plot: "Earth's mightiest heroes must come together and learn to fight as a team if they are going to stop the mischievous Loki and his alien army from enslaving humanity.", Director: "Joss Whedon", Actors: "Robert Downey Jr., Chris Evans, Scarlett Johansson", imdbRating: "8.0" },
            { imdbID: "tt0111161", Title: "The Shawshank Redemption", Year: "1994", Poster: "https://m.media-amazon.com/images/M/MV5BNDE3ODcxYzMtY2YzZC00NmNlLWJiNDMtZDViZWM2MzIxZDYwXkEyXkFqcGdeQXVyNjAwNDUxODI@._V1_SX300.jpg", Genre: "Drama", Plot: "Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.", Director: "Frank Darabont", Actors: "Tim Robbins, Morgan Freeman, Bob Gunton", imdbRating: "9.3" },
            { imdbID: "tt0133093", Title: "The Matrix", Year: "1999", Poster: "https://m.media-amazon.com/images/M/MV5BNzQzOTk3OTAtNDQ0Zi00ZTVkLWI0MTEtMDllZjNkYzNjNTc4L2ltYWdlXkEyXkFqcGdeQXVyNjU0OTQ0OTY@._V1_SX300.jpg", Genre: "Action, Sci-Fi", Plot: "A computer hacker learns from mysterious rebels about the true nature of his reality and his role in the war against its controllers.", Director: "Lana Wachowski, Lilly Wachowski", Actors: "Keanu Reeves, Laurence Fishburne, Carrie-Anne Moss", imdbRating: "8.7" },
            { imdbID: "tt1375666", Title: "Inception", Year: "2010", Poster: "https://m.media-amazon.com/images/M/MV5BMjAxMzY3NjcxNF5BMl5BanBnXkFtZTcwNTI5OTM0Mw@@._V1_SX300.jpg", Genre: "Action, Adventure, Sci-Fi", Plot: "A thief who steals corporate secrets through the use of dream-sharing technology is given the inverse task of planting an idea into the mind of a C.E.O.", Director: "Christopher Nolan", Actors: "Leonardo DiCaprio, Joseph Gordon-Levitt, Elliot Page", imdbRating: "8.8" },
            { imdbID: "tt0120737", Title: "The Lord of the Rings: The Fellowship of the Ring", Year: "2001", Poster: "https://m.media-amazon.com/images/M/MV5BN2EyZjM3NzUtNWUzMi00MTgxLWI0NTctMzY4M2VlOTdjZWRiXkEyXkFqcGdeQXVyNDUzOTQ5MjY@._V1_SX300.jpg", Genre: "Adventure, Drama, Fantasy", Plot: "A meek Hobbit from the Shire and eight companions set out on a journey to destroy the powerful One Ring and save Middle-earth from the Dark Lord Sauron.", Director: "Peter Jackson", Actors: "Elijah Wood, Ian McKellen, Orlando Bloom", imdbRating: "8.8" },
            { imdbID: "tt0167260", Title: "The Lord of the Rings: The Return of the King", Year: "2003", Poster: "https://m.media-amazon.com/images/M/MV5BNzA5ZDNlZWMtM2NhNS00NDJjLTk4NDItYTRmY2EwMWZlMTY3XkEyXkFqcGdeQXVyNzkwMjQ5NzM@._V1_SX300.jpg", Genre: "Adventure, Drama, Fantasy", Plot: "Gandalf and Aragorn lead the World of Men against Sauron's army to draw his gaze from Frodo and Sam as they approach Mount Doom with the One Ring.", Director: "Peter Jackson", Actors: "Elijah Wood, Viggo Mortensen, Ian McKellen", imdbRating: "9.0" },
            { imdbID: "tt0137523", Title: "Fight Club", Year: "1999", Poster: "https://m.media-amazon.com/images/M/MV5BNDIzNDU0YzEtYzE5Ni00ZjlkLTk5ZjgtNjM3NWE4YzA3Nzk3XkEyXkFqcGdeQXVyMjUzOTY1NTc@._V1_SX300.jpg", Genre: "Drama", Plot: "An insomniac office worker and a devil-may-care soapmaker form an underground fight club that evolves into something much, much more.", Director: "David Fincher", Actors: "Brad Pitt, Edward Norton, Helena Bonham Carter", imdbRating: "8.8" },
            { imdbID: "tt0076759", Title: "Star Wars: Episode IV - A New Hope", Year: "1977", Poster: "https://m.media-amazon.com/images/M/MV5BOTA5NjhiOTAtZWM0ZC00MWNhLThiMzEtZDFkOTk2OTU1ZDJkXkEyXkFqcGdeQXVyMTA4NDI1NTQx._V1_SX300.jpg", Genre: "Action, Adventure, Fantasy", Plot: "Luke Skywalker joins forces with a Jedi Knight, a cocky pilot, a Wookiee and two droids to save the galaxy from the Empire's world-destroying battle station, while also attempting to rescue Princess Leia from the mysterious Darth Vader.", Director: "George Lucas", Actors: "Mark Hamill, Harrison Ford, Carrie Fisher", imdbRating: "8.6" },
            { imdbID: "tt0080684", Title: "Star Wars: Episode V - The Empire Strikes Back", Year: "1980", Poster: "https://m.media-amazon.com/images/M/MV5BYmU1NDRjNDgtMzhiMi00NjZmLTg5NGItZDNiZjU5NTU4OTE0XkEyXkFqcGdeQXVyNzkwMjQ5NzM@._V1_SX300.jpg", Genre: "Action, Adventure, Fantasy", Plot: "After the Rebels are overpowered by the Empire, Luke Skywalker begins Jedi training with Yoda, while his friends are pursued by Darth Vader.", Director: "Irvin Kershner", Actors: "Mark Hamill, Harrison Ford, Carrie Fisher", imdbRating: "8.7" },
            { imdbID: "tt0086190", Title: "Star Wars: Episode VI - Return of the Jedi", Year: "1983", Poster: "https://m.media-amazon.com/images/M/MV5BOWZlMjFiYzgtMTUzNC00Y2IzLTk1NTMtZmNhMTczNTk0ODk1XkEyXkFqcGdeQXVyNTAyODkwOQ@@._V1_SX300.jpg", Genre: "Action, Adventure, Fantasy", Plot: "After a daring mission to rescue Han Solo from Jabba the Hutt, the Rebels dispatch to Endor to destroy the second Death Star. Meanwhile, Luke struggles to help Darth Vader back from the dark side without falling into the Emperor's trap.", Director: "Richard Marquand", Actors: "Mark Hamill, Harrison Ford, Carrie Fisher", imdbRating: "8.3" },
            { imdbID: "tt0110912", Title: "Pulp Fiction", Year: "1994", Poster: "https://m.media-amazon.com/images/M/MV5BNGNhMDIzZTUtNTBlZi00MTRlLWFjM2ItYzJjNDymmYzYzYmFkXkEyXkFqcGdeQXVyNzkwMjQ5NzM@._V1_SX300.jpg", Genre: "Crime, Drama", Plot: "The lives of two mob hitmen, a boxer, a gangster and his wife, and a pair of diner bandits intertwine in four tales of violence and redemption.", Director: "Quentin Tarantino", Actors: "John Travolta, Uma Thurman, Samuel L. Jackson", imdbRating: "8.9" },
            { imdbID: "tt0109830", Title: "Forrest Gump", Year: "1994", Poster: "https://m.media-amazon.com/images/M/MV5BNWIwODRlZTUtY2U3ZS00Yzg1LWJhNzYtMmZiYmEyNmU1NjMzXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_SX300.jpg", Genre: "Drama, Romance", Plot: "The presidencies of Kennedy and Johnson, the events of Vietnam, Watergate, and other historical events unfold through the perspective of an Alabama man with an IQ of 75, whose only desire is to be reunited with his childhood sweetheart.", Director: "Robert Zemeckis", Actors: "Tom Hanks, Robin Wright, Gary Sinise", imdbRating: "8.8" },
            { imdbID: "tt0120815", Title: "Saving Private Ryan", Year: "1998", Poster: "https://m.media-amazon.com/images/M/MV5BZjhkMDM4MWItZTVjOC00ZDRhLThmYTAtM2I5NzBmNmNlMzI1XkEyXkFqcGdeQXVyNDYyMDk5MTU@._V1_SX300.jpg", Genre: "Drama, War", Plot: "Following the Normandy Landings, a group of U.S. soldiers go behind enemy lines to retrieve a paratrooper whose brothers have been killed in action.", Director: "Steven Spielberg", Actors: "Tom Hanks, Matt Damon, Tom Sizemore", imdbRating: "8.6" },
            { imdbID: "tt0110357", Title: "The Lion King", Year: "1994", Poster: "https://m.media-amazon.com/images/M/MV5BYTYxNGMyZTYtMjE3MS00MzNjLWFjNmYtMDk3N2FmM2JiM2M1XkEyXkFqcGdeQXVyNjY5NDU4NzI@._V1_SX300.jpg", Genre: "Animation, Adventure, Drama", Plot: "Lion prince Simba and his father are targeted by his bitter uncle, who wants to ascend the throne himself.", Director: "Roger Allers, Rob Minkoff", Actors: "Matthew Broderick, Jeremy Irons, James Earl Jones", imdbRating: "8.5" },
            { imdbID: "tt0317705", Title: "The Incredibles", Year: "2004", Poster: "https://m.media-amazon.com/images/M/MV5BMTY5OTU0OTc2NV5BMl5BanBnXkFtZTcwMzU4MDcyMQ@@._V1_SX300.jpg", Genre: "Animation, Action, Adventure", Plot: "A family of undercover superheroes, while trying to live the quiet suburban life, are forced into action to save the world.", Director: "Brad Bird", Actors: "Craig T. Nelson, Samuel L. Jackson, Holly Hunter", imdbRating: "8.0" },
            { imdbID: "tt0241527", Title: "Harry Potter and the Sorcerer's Stone", Year: "2001", Poster: "https://m.media-amazon.com/images/M/MV5BNmQ0ODBhMjUtNDRhOC00MGQzLTk5MTAtZDliODg5NmU5MjZhXkEyXkFqcGdeQXVyNDUyOTg3Njg@._V1_SX300.jpg", Genre: "Adventure, Family, Fantasy", Plot: "An orphaned boy enrolls in a school of wizardry, where he learns the truth about himself, his family and the terrible evil that haunts the magical world.", Director: "Chris Columbus", Actors: "Daniel Radcliffe, Rupert Grint, Richard Harris", imdbRating: "7.6" },
            { imdbID: "tt0295297", Title: "Harry Potter and the Chamber of Secrets", Year: "2002", Poster: "https://m.media-amazon.com/images/M/MV5BMjE0YjUzNDUtMjc5OS00MTU3LTgxMmUtODhkOThkMzdjNWI4XkEyXkFqcGdeQXVyMTA3MzQ4MTc0._V1_SX300.jpg", Genre: "Adventure, Family, Fantasy", Plot: "An ancient prophecy seems to be coming true when a mysterious presence begins stalking the corridors of a school of magic and leaving its victims paralyzed.", Director: "Chris Columbus", Actors: "Daniel Radcliffe, Rupert Grint, Emma Watson", imdbRating: "7.4" },
            { imdbID: "tt0304141", Title: "Harry Potter and the Prisoner of Azkaban", Year: "2004", Poster: "https://m.media-amazon.com/images/M/MV5BMTY4NTIwODg0N15BMl5BanBnXkFtZTcwOTc0MjEzMw@@._V1_SX300.jpg", Genre: "Adventure, Family, Fantasy", Plot: "Harry Potter, Ron and Hermione return to Hogwarts School of Witchcraft and Wizardry for their third year of study, where they delve into the mystery surrounding an escaped prisoner who poses a dangerous threat to the young wizard.", Director: "Alfonso Cuar√≥n", Actors: "Daniel Radcliffe, Emma Watson, Rupert Grint", imdbRating: "7.9" },
            { imdbID: "tt0330373", Title: "Harry Potter and the Goblet of Fire", Year: "2005", Poster: "https://m.media-amazon.com/images/M/MV5BMTI1NDMyMjExOF5BMl5BanBnXkFtZTcwOTc4MjQzMQ@@._V1_SX300.jpg", Genre: "Adventure, Family, Fantasy", Plot: "Harry Potter finds himself competing in a hazardous tournament between rival schools of magic, but he is distracted by recurring nightmares.", Director: "Mike Newell", Actors: "Daniel Radcliffe, Emma Watson, Rupert Grint", imdbRating: "7.7" },
            { imdbID: "tt0373889", Title: "Harry Potter and the Order of the Phoenix", Year: "2007", Poster: "https://m.media-amazon.com/images/M/MV5BOTA3MmRmZDgtOWU1Ny00ZDc5LWFkN2YtNzNlY2U2ZmFlODY5XkEyXkFqcGdeQXVyNTIzOTk5ODM@._V1_SX300.jpg", Genre: "Adventure, Family, Fantasy", Plot: "With their warning about Lord Voldemort's return scoffed at, Harry and Dumbledore are targeted by the Wizard authorities as an authoritarian bureaucrat slowly seizes power at Hogwarts.", Director: "David Yates", Actors: "Daniel Radcliffe, Emma Watson, Rupert Grint", imdbRating: "7.5" },
            { imdbID: "tt0417741", Title: "Harry Potter and the Half-Blood Prince", Year: "2009", Poster: "https://m.media-amazon.com/images/M/MV5BNzU3NDg4NTAyNV5BMl5BanBnXkFtZTcwOTg2ODg1Mg@@._V1_SX300.jpg", Genre: "Action, Adventure, Family", Plot: "As Harry Potter begins his sixth year at Hogwarts, he discovers an old book marked as 'the property of the Half-Blood Prince' and begins to learn more about Lord Voldemort's dark past.", Director: "David Yates", Actors: "Daniel Radcliffe, Emma Watson, Rupert Grint", imdbRating: "7.6" },
            { imdbID: "tt0926084", Title: "Harry Potter and the Deathly Hallows: Part 1", Year: "2010", Poster: "https://m.media-amazon.com/images/M/MV5BMTQ2OTE1Mjk0N15BMl5BanBnXkFtZTcwODE3MDAwNA@@._V1_SX300.jpg", Genre: "Adventure, Family, Fantasy", Plot: "As Harry, Ron and Hermione race against time and evil to destroy the Horcruxes, they uncover the existence of the three most powerful objects in the wizarding world: the Deathly Hallows.", Director: "David Yates", Actors: "Daniel Radcliffe, Emma Watson, Rupert Grint", imdbRating: "7.7" },
            { imdbID: "tt1201607", Title: "Harry Potter and the Deathly Hallows: Part 2", Year: "2011", Poster: "https://m.media-amazon.com/images/M/MV5BMGVmMWNiMDktYjQ0Mi00MWIxLTk0N2UtN2ZlYTdkN2IzNDNlXkEyXkFqcGdeQXVyODE5NzE3OTE@._V1_SX300.jpg", Genre: "Adventure, Drama, Fantasy", Plot: "Harry, Ron, and Hermione search for Voldemort's remaining Horcruxes in their effort to destroy the Dark Lord as the final battle rages on at Hogwarts.", Director: "David Yates", Actors: "Daniel Radcliffe, Emma Watson, Rupert Grint", imdbRating: "8.1" },
            { imdbID: "tt0468569", Title: "The Dark Knight", Year: "2008", Poster: "https://m.media-amazon.com/images/M/MV5BMTMxNTMwODM0NF5BMl5BanBnXkFtZTcwODAyMTk2Mw@@._V1_SX300.jpg", Genre: "Action, Crime, Drama", Plot: "When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.", Director: "Christopher Nolan", Actors: "Christian Bale, Heath Ledger, Aaron Eckhart", imdbRating: "9.0" },
            { imdbID: "tt1345836", Title: "The Dark Knight Rises", Year: "2012", Poster: "https://m.media-amazon.com/images/M/MV5BMTk4ODQzNDY3Ml5BMl5BanBnXkFtZTcwODA0NTM4Nw@@._V1_SX300.jpg", Genre: "Action, Adventure", Plot: "Eight years after the Joker's reign of anarchy, Batman, with the help of the enigmatic Catwoman, is forced from his exile to save Gotham City from the brutal guerrilla terrorist Bane.", Director: "Christopher Nolan", Actors: "Christian Bale, Tom Hardy, Anne Hathaway", imdbRating: "8.4" },
            { imdbID: "tt0114709", Title: "Toy Story", Year: "1995", Poster: "https://m.media-amazon.com/images/M/MV5BMDU2ZWJlMjktMTRhMy00ZTA5LWEzNDgtYmNmZTEwZTViZWJkXkEyXkFqcGdeQXVyNDQ2OTk4MzI@._V1_SX300.jpg", Genre: "Animation, Adventure, Comedy", Plot: "A cowboy doll is profoundly threatened and jealous when a new spaceman figure supplants him as top toy in a boy's room.", Director: "John Lasseter", Actors: "Tom Hanks, Tim Allen, Don Rickles", imdbRating: "8.3" },
            { imdbID: "tt0120363", Title: "Toy Story 2", Year: "1999", Poster: "https://m.media-amazon.com/images/M/MV5BMWM5ZDcxMTYtNTEyNS00MDRkLWI3YTItNThmMGExMWY4NDIwXkEyXkFqcGdeQXVyNjUwNzk3NDc@._V1_SX300.jpg", Genre: "Animation, Adventure, Comedy", Plot: "When Woody is stolen by a toy collector, Buzz and his friends set out on a rescue mission to save Woody before he becomes a museum toy property with his roundup gang Jessie, Prospector, and Bullseye.", Director: "John Lasseter, Ash Brannon, Lee Unkrich", Actors: "Tom Hanks, Tim Allen, Joan Cusack", imdbRating: "7.9" },
            { imdbID: "tt0435761", Title: "Toy Story 3", Year: "2010", Poster: "https://m.media-amazon.com/images/M/MV5BMTgxOTY4Mjc0MF5BMl5BanBnXkFtZTcwNta4MDQyMw@@._V1_SX300.jpg", Genre: "Animation, Adventure, Comedy", Plot: "The toys are mistakenly delivered to a day-care center instead of the attic right before Andy leaves for college, and it's up to Woody to convince the other toys that they weren't abandoned and to return home.", Director: "Lee Unkrich", Actors: "Tom Hanks, Tim Allen, Joan Cusack", imdbRating: "8.3" },
            { imdbID: "tt1979376", Title: "Toy Story 4", Year: "2019", Poster: "https://m.media-amazon.com/images/M/MV5BMTYzMDM4NzkxOV5BMl5BanBnXkFtZTgwNzM1Mzg2NzM@._V1_SX300.jpg", Genre: "Animation, Adventure, Comedy", Plot: "When a new toy called 'Forky' joins Woody and the gang, a road trip alongside old and new friends reveals how big the world can be for a toy.", Director: "Josh Cooley", Actors: "Tom Hanks, Tim Allen, Annie Potts", imdbRating: "7.7" },
            { imdbID: "tt0119217", Title: "Good Will Hunting", Year: "1997", Poster: "https://m.media-amazon.com/images/M/MV5BOTI0MzcxMTYtZDVkMy00NjY1LTgyMTYtZmUxN2M3NmQ2NWJhXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_SX300.jpg", Genre: "Drama, Romance", Plot: "Will Hunting, a janitor at M.I.T., has a gift for mathematics, but needs help from a psychologist to find direction in his life.", Director: "Gus Van Sant", Actors: "Robin Williams, Matt Damon, Ben Affleck", imdbRating: "8.3" },
            { imdbID: "tt0108052", Title: "Schindler's List", Year: "1993", Poster: "https://m.media-amazon.com/images/M/MV5BNDE4OTMxMTctNmRhYy00NWE2LTg3YzItYTk3M2UwOTU5Njg4XkEyXkFqcGdeQXVyNjU0OTQ0OTY@._V1_SX300.jpg", Genre: "Biography, Drama, History", Plot: "In German-occupied Poland during World War II, industrialist Oskar Schindler gradually becomes concerned for his Jewish workforce after witnessing their persecution by the Nazis.", Director: "Steven Spielberg", Actors: "Liam Neeson, Ralph Fiennes, Ben Kingsley", imdbRating: "9.0" },
            { imdbID: "tt0088763", Title: "Back to the Future", Year: "1985", Poster: "https://m.media-amazon.com/images/M/MV5BZmU0M2Y1OGUtZjIxNi00ZjBkLTg1MjgtOWIyNThiZWIwYjRiXkEyXkFqcGdeQXVyMTQxNzMzNDI@._V1_SX300.jpg", Genre: "Adventure, Comedy, Sci-Fi", Plot: "Marty McFly, a 17-year-old high school student, is accidentally sent thirty years into the past in a time-traveling DeLorean invented by his close friend, the eccentric scientist Doc Brown.", Director: "Robert Zemeckis", Actors: "Michael J. Fox, Christopher Lloyd, Lea Thompson", imdbRating: "8.5" }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            loadAIModel();
            showPage('home');
        });

        function showPage(pageId) {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('catalog-page').classList.add('hidden');
            document.getElementById('detail-page').classList.add('hidden');
            document.getElementById(`${pageId}-page`).classList.remove('hidden');
            if (pageId === 'catalog') loadMovies();
        }

        function loadMovies() {
            const resultsContainer = document.getElementById('search-results');
            const loadingIndicator = document.getElementById('loading-indicator');
            const errorMessage = document.getElementById('error-message');
            
            resultsContainer.innerHTML = '';
            loadingIndicator.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            
            setTimeout(() => {
                loadingIndicator.classList.add('hidden');
                currentMovies = sampleMovies;
                displayMovies(currentMovies);
            }, 1000);
        }

        function displayMovies(movies) {
            const resultsContainer = document.getElementById('search-results');
            
            if (movies.length === 0) {
                resultsContainer.innerHTML = '<div class="col-span-full text-center py-12"><p class="text-xl">No se encontraron pel√≠culas. Intenta con otros t√©rminos de b√∫squeda.</p></div>';
                return;
            }
            
            resultsContainer.innerHTML = movies.map(movie => `
                <article class="bg-gray-800 rounded-lg shadow-lg overflow-hidden movie-card h-full flex flex-col">
                    <div class="relative">
                        <img src="${movie.Poster}" alt="P√≥ster de ${movie.Title}" class="poster-image" onerror="this.onerror=null; this.classList.add('placeholder-movie'); this.src=''; this.innerHTML='üé¨'"/>
                        <div class="absolute top-2 right-2 bg-blue-600 text-white px-2 py-1 rounded text-sm">${movie.Year}</div>
                    </div>
                    <div class="p-4 flex-grow flex flex-col">
                        <h2 class="text-xl font-semibold mb-2">${movie.Title}</h2>
                        <p class="text-gray-400 mb-4">A√±o: ${movie.Year}</p>
                        <div class="mt-auto">
                            <button onclick="showMovieDetail('${movie.imdbID}')" class="w-full bg-blue-600 hover:bg-blue-700 py-2 rounded-lg transition duration-300">Ver detalles</button>
                        </div>
                    </div>
                </article>
            `).join('');
        }

        function handleSearch(event) {
            event.preventDefault();
            const searchInput = document.getElementById('search-input');
            const searchTerm = searchInput.value.trim();
            
            if (searchTerm) {
                const loadingIndicator = document.getElementById('loading-indicator');
                const errorMessage = document.getElementById('error-message');
                
                loadingIndicator.classList.remove('hidden');
                errorMessage.classList.add('hidden');
                
                setTimeout(() => {
                    loadingIndicator.classList.add('hidden');
                    const filteredMovies = sampleMovies.filter(movie => movie.Title.toLowerCase().includes(searchTerm.toLowerCase()));
                    currentMovies = filteredMovies;
                    displayMovies(filteredMovies);
                    if (filteredMovies.length === 0) showError('No se encontraron pel√≠culas con ese t√©rmino.');
                }, 1000);
            }
        }

        function filterByGenre(genre) {
            const filteredMovies = sampleMovies.filter(movie => movie.Genre.toLowerCase().includes(genre.toLowerCase()));
            currentMovies = filteredMovies;
            displayMovies(filteredMovies);
            if (filteredMovies.length === 0) showError(`No hay pel√≠culas del g√©nero "${genre}".`);
        }

        function clearFilters() {
            document.getElementById('search-input').value = '';
            currentMovies = sampleMovies;
            displayMovies(sampleMovies);
        }

        function showError(message) {
            const errorMessage = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            errorText.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        function showMovieDetail(movieId) {
            showPage('detail');
            const movie = sampleMovies.find(m => m.imdbID === movieId);
            const detailContainer = document.getElementById('movie-detail-content');
            
            if (movie) {
                // Obtener plataformas para esta pel√≠cula
                const platforms = moviePlatforms[movieId] || [];
                
                // Obtener comentarios para esta pel√≠cula
                const comments = movieComments[movieId] || [];
                
                detailContainer.innerHTML = `
                    <div class="bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-10">
                        <div class="md:flex">
                            <div class="md:flex-shrink-0">
                                <img src="${movie.Poster}" alt="${movie.Title}" class="poster-image md:w-80" onerror="this.onerror=null; this.classList.add('placeholder-movie'); this.src=''; this.innerHTML='üé¨'"/>
                            </div>
                            <div class="p-8">
                                <h1 class="text-3xl font-bold mb-2">${movie.Title}</h1>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="bg-blue-600 text-white px-3 py-1 rounded-full text-sm">${movie.Year}</span>
                                    <span class="bg-green-600 text-white px-3 py-1 rounded-full text-sm">${movie.imdbRating}/10</span>
                                    <span class="bg-purple-600 text-white px-3 py-1 rounded-full text-sm">${movie.Genre}</span>
                                </div>
                                
                                <div class="mb-6">
                                    <h2 class="text-xl font-semibold mb-2">Sinopsis</h2>
                                    <p class="text-gray-300">${movie.Plot}</p>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                    <div><h3 class="font-semibold mb-1">Director</h3><p class="text-gray-300">${movie.Director}</p></div>
                                    <div><h3 class="font-semibold mb-1">Reparto</h3><p class="text-gray-300">${movie.Actors}</p></div>
                                </div>
                                
                                ${platforms.length > 0 ? `
                                <div class="mb-6">
                                    <h3 class="text-xl font-semibold mb-3">Disponible en:</h3>
                                    <div class="flex flex-wrap gap-3">
                                        ${platforms.map(platform => `
                                            <div class="flex items-center ${streamingPlatforms[platform].color} px-3 py-2 rounded-lg">
                                                <i class="${streamingPlatforms[platform].icon} mr-2"></i>
                                                <span>${platform}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 rounded-lg shadow-lg p-6 mb-10">
                        <h2 class="text-2xl font-bold mb-4">Sistema de Recomendaci√≥n con IA</h2>
                        <div class="mb-6">
                            <p class="mb-4">Valora esta pel√≠cula y nuestro sistema de IA te recomendar√° pel√≠culas similares:</p>
                            <div class="mb-6">
                                <label class="block text-lg font-semibold mb-2">Tu valoraci√≥n:</label>
                                <div class="flex items-center mb-2" id="rating-stars">
                                    ${[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map(star => `<button class="text-2xl mx-1 text-gray-400 hover:text-yellow-300" onclick="rateMovie(${star}, '${movieId}')">‚òÖ</button>`).join('')}
                                    <span class="ml-3 font-semibold" id="rating-value">0/10</span>
                                </div>
                            </div>
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg w-full" onclick="getRecommendation('${movieId}')" id="recommendation-btn" disabled>Obtener Recomendaciones</button>
                        </div>
                        <div id="recommendation-result"></div>
                    </div>
                    
                    <div class="bg-gray-800 rounded-lg shadow-lg p-6">
                        <h2 class="text-2xl font-bold mb-4">Comentarios</h2>
                        
                        <form onsubmit="addComment(event, '${movieId}')" class="mb-8">
                            <div class="mb-4">
                                <label for="comment-name" class="block text-lg font-semibold mb-2">Tu nombre:</label>
                                <input type="text" id="comment-name" required class="w-full px-4 py-2 rounded-lg bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Ingresa tu nombre">
                            </div>
                            <div class="mb-4">
                                <label for="comment-text" class="block text-lg font-semibold mb-2">Tu comentario:</label>
                                <textarea id="comment-text" required rows="4" class="w-full px-4 py-2 rounded-lg bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Escribe tu comentario aqu√≠..."></textarea>
                            </div>
                            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg">Publicar Comentario</button>
                        </form>
                        
                        <div id="comments-container">
                            ${comments.length > 0 ? 
                                comments.map(comment => `
                                    <div class="comment p-4 rounded-lg mb-4">
                                        <div class="flex justify-between items-center mb-2">
                                            <h4 class="font-semibold">${comment.name}</h4>
                                            <span class="text-sm text-gray-400">${comment.date}</span>
                                        </div>
                                        <p class="text-gray-300">${comment.text}</p>
                                    </div>
                                `).join('') 
                                : '<p class="text-gray-400 text-center py-4">No hay comentarios a√∫n. ¬°S√© el primero en comentar!</p>'
                            }
                        </div>
                    </div>
                `;
                
                // Restaurar calificaci√≥n si existe
                const savedRating = localStorage.getItem(`rating_${movieId}`);
                if (savedRating) {
                    rateMovie(parseInt(savedRating), movieId);
                }
            }
        }

        function addComment(event, movieId) {
            event.preventDefault();
            
            const nameInput = document.getElementById('comment-name');
            const textInput = document.getElementById('comment-text');
            
            const comment = {
                name: nameInput.value,
                text: textInput.value,
                date: new Date().toLocaleDateString('es-ES', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                })
            };
            
            // Inicializar array de comentarios si no existe
            if (!movieComments[movieId]) {
                movieComments[movieId] = [];
            }
            
            // Agregar comentario
            movieComments[movieId].unshift(comment);
            
            // Guardar en localStorage
            localStorage.setItem('movieComments', JSON.stringify(movieComments));
            
            // Limpiar formulario
            nameInput.value = '';
            textInput.value = '';
            
            // Actualizar visualizaci√≥n de comentarios
            const commentsContainer = document.getElementById('comments-container');
            commentsContainer.innerHTML = movieComments[movieId].map(c => `
                <div class="comment p-4 rounded-lg mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="font-semibold">${c.name}</h4>
                        <span class="text-sm text-gray-400">${c.date}</span>
                    </div>
                    <p class="text-gray-300">${c.text}</p>
                </div>
            `).join('');
        }

        function rateMovie(rating, movieId) {
            const stars = document.querySelectorAll('#rating-stars button');
            const ratingValue = document.getElementById('rating-value');
            const recommendationBtn = document.getElementById('recommendation-btn');
            
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('text-yellow-400');
                    star.classList.remove('text-gray-400');
                } else {
                    star.classList.remove('text-yellow-400');
                    star.classList.add('text-gray-400');
                }
            });
            
            ratingValue.textContent = `${rating}/10`;
            recommendationBtn.disabled = false;
            localStorage.setItem(`rating_${movieId}`, rating);
        }

        async function loadAIModel() {
            try {
                console.log('Modelo de IA simulado cargado correctamente');
            } catch (error) {
                console.error('Error cargando el modelo de IA:', error);
            }
        }

        async function getRecommendation(movieId) {
            const rating = localStorage.getItem(`rating_${movieId}`) || 5;
            const resultContainer = document.getElementById('recommendation-result');
            const movie = sampleMovies.find(m => m.imdbID === movieId);
            
            resultContainer.innerHTML = '<div class="text-center py-4"><div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div><p class="mt-2">Analizando tus preferencias con IA...</p></div>';
            
            setTimeout(() => {
                const similarMovies = sampleMovies.filter(m => m.imdbID !== movieId).slice(0, 3);
                resultContainer.innerHTML = `
                    <div class="bg-green-900 text-green-200 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2">¬°Recomendaci√≥n Generada!</h3>
                        <p>Basado en tus preferencias, te recomendamos estas pel√≠culas similares:</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                            ${similarMovies.map(m => `
                                <div class="bg-gray-700 p-3 rounded-lg">
                                    <h4 class="font-semibold">${m.Title}</h4>
                                    <p class="text-sm">${m.Year} ‚Ä¢ ${m.Genre}</p>
                                    <button onclick="showMovieDetail('${m.imdbID}')" class="mt-2 bg-green-600 hover:bg-green-700 text-white text-sm py-1 px-3 rounded w-full">Ver detalles</button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }, 2000);
        }
    </script>
</body>
</html>
